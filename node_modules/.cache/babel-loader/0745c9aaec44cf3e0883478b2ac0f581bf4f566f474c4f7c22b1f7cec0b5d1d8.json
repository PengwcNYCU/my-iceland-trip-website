{"ast":null,"code":"// src/components/iceland-trip/EnhancedWeatherWidget.js\nimport React,{useState,useEffect,useRef}from'react';import{CloudSnow,Wind,Droplets,Thermometer,Sun,Sunset,Eye,CloudRain,Clock,ArrowDown,ArrowUp,Compass,Gauge,Navigation,RefreshCw,Info,AlertTriangle}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const EnhancedWeatherWidget=_ref=>{let{theme}=_ref;const[currentWeather,setCurrentWeather]=useState(null);const[forecast,setForecast]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[activeHourlyPage,setActiveHourlyPage]=useState(0);const[activeTab,setActiveTab]=useState('current');// 'current', 'hourly', 'daily'\nconst[lastUpdated,setLastUpdated]=useState(null);const[animateRefresh,setAnimateRefresh]=useState(false);const[animateTemperature,setAnimateTemperature]=useState(false);const[showTooltip,setShowTooltip]=useState(null);// 用於溫度變化動畫的ref\nconst prevTempRef=useRef(null);const tempChangeRef=useRef(null);// 主要冰島旅遊地點\nconst travelLocations=[{name:\"雷克雅維克\",lat:64.1466,lon:-21.9426},{name:\"教會山\",lat:64.927,lon:-23.308},{name:\"黃金圈\",lat:64.255,lon:-21.130},{name:\"藍湖\",lat:63.880,lon:-22.449},{name:\"冰河湖\",lat:64.047,lon:-16.181}];const[selectedLocation,setSelectedLocation]=useState(travelLocations[0]);// 監視地點變化，獲取數據\nuseEffect(()=>{fetchWeatherData();},[selectedLocation]);// 設置溫度動畫效果\nuseEffect(()=>{if(currentWeather&&prevTempRef.current!==null){const currentTemp=Math.round(currentWeather.main.temp);if(prevTempRef.current!==currentTemp){setAnimateTemperature(true);tempChangeRef.current=currentTemp>prevTempRef.current?'up':'down';// 動畫結束後重置\nconst timer=setTimeout(()=>{setAnimateTemperature(false);},1000);return()=>clearTimeout(timer);}}if(currentWeather){prevTempRef.current=Math.round(currentWeather.main.temp);}},[currentWeather]);const fetchWeatherData=async()=>{try{setLoading(true);setAnimateRefresh(true);// 啟動刷新按鈕動畫\nconst apiKey=process.env.REACT_APP_OPENWEATHER_API_KEY;// 使用當前天氣 API (免費可用)\nconst currentRes=await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${selectedLocation.lat}&lon=${selectedLocation.lon}&units=metric&appid=${apiKey}`);// 使用 5-day/3-hour forecast API (免費可用)\nconst forecastRes=await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${selectedLocation.lat}&lon=${selectedLocation.lon}&units=metric&appid=${apiKey}`);if(!currentRes.ok){console.error(\"Current weather API failed:\",currentRes.status,currentRes.statusText);throw new Error(`Current weather API error: ${currentRes.status}`);}if(!forecastRes.ok){console.error(\"Forecast API failed:\",forecastRes.status,forecastRes.statusText);throw new Error(`Forecast API error: ${forecastRes.status}`);}const currentData=await currentRes.json();const forecastData=await forecastRes.json();// 處理當前天氣數據\nsetCurrentWeather({...currentData,main:{...currentData.main,sunrise:currentData.sys.sunrise,sunset:currentData.sys.sunset,visibility:currentData.visibility}});// 處理小時預報 (取前 24 小時 / 8 個時間點)\nconst hourlyForecast=forecastData.list.slice(0,8).map(item=>({dt:item.dt,temp:item.main.temp,feels_like:item.main.feels_like,humidity:item.main.humidity,weather:item.weather,pop:item.pop||0,// 降水概率\nwind_speed:item.wind.speed}));// 處理日預報 (每天取中午的預報作為代表)\nconst dailyForecast=[];const groupedByDay={};// 以日期為鍵分組\nforecastData.list.forEach(item=>{const date=new Date(item.dt*1000).toLocaleDateString();if(!groupedByDay[date]){groupedByDay[date]=[];}groupedByDay[date].push(item);});// 每天取中午的預報\nObject.entries(groupedByDay).forEach((_ref2,index)=>{let[date,items]=_ref2;if(index<5){// 最多取 5 天 (API 限制)\n// 尋找最接近中午的預報\nconst noon=new Date(date);noon.setHours(12,0,0,0);const noonTimestamp=noon.getTime()/1000;// 找到最接近中午的預報\nconst closestToDayItem=items.reduce((prev,curr)=>{return Math.abs(curr.dt-noonTimestamp)<Math.abs(prev.dt-noonTimestamp)?curr:prev;},items[0]);// 計算溫度範圍\nconst temps=items.map(item=>item.main.temp);const maxTemp=Math.max(...temps);const minTemp=Math.min(...temps);// 計算最大降水概率\nconst maxPop=Math.max(...items.map(item=>item.pop||0));dailyForecast.push({dt:closestToDayItem.dt,temp:{day:closestToDayItem.main.temp,min:minTemp,max:maxTemp},weather:closestToDayItem.weather,pop:maxPop,// 使用當天最大降水概率\nwind_speed:closestToDayItem.wind.speed});}});setForecast({hourly:hourlyForecast,daily:dailyForecast});setLastUpdated(new Date());setError(null);}catch(err){console.error(\"Failed to fetch weather data:\",err);setError(`無法獲取天氣數據: ${err.message}`);}finally{setLoading(false);// 延遲重置刷新動畫，讓動畫能完整播放\nsetTimeout(()=>{setAnimateRefresh(false);},800);}};// 輔助函數\n// 取得天氣圖示並添加動畫效果\nconst getWeatherIcon=iconCode=>{return`https://openweathermap.org/img/wn/${iconCode}@2x.png`;};// 根據天氣狀況獲取動畫效果類名\nconst getWeatherAnimationClass=iconCode=>{if(!iconCode)return'';// 下雨\nif(iconCode.includes('09')||iconCode.includes('10')){return'animate-rain';}// 下雪\nelse if(iconCode.includes('13')){return'animate-snow';}// 雷雨\nelse if(iconCode.includes('11')){return'animate-thunder';}// 霧\nelse if(iconCode.includes('50')){return'animate-mist';}// 多雲\nelse if(iconCode.includes('02')||iconCode.includes('03')||iconCode.includes('04')){return'animate-cloud';}// 晴天\nelse if(iconCode.includes('01')){return'animate-sun';}return'';};// 格式化時間 (Unix timestamp)\nconst formatTime=timestamp=>{const date=new Date(timestamp*1000);return date.toLocaleTimeString('zh-TW',{hour:'2-digit',minute:'2-digit'});};// 格式化日期 (Unix timestamp)\nconst formatDay=timestamp=>{const date=new Date(timestamp*1000);const days=['週日','週一','週二','週三','週四','週五','週六'];return days[date.getDay()];};// 取得風向文字\nconst getWindDirection=deg=>{const directions=['北','東北','東','東南','南','西南','西','西北'];return directions[Math.round(deg/45)%8];};// 格式化上次更新時間\nconst formatLastUpdated=()=>{if(!lastUpdated)return'';return`最後更新: ${lastUpdated.toLocaleTimeString('zh-TW')}`;};// 渲染當前天氣板塊\nconst renderCurrentWeather=()=>{if(!currentWeather)return null;const weather=currentWeather.weather[0];const main=currentWeather.main;const wind=currentWeather.wind;const isDarkMode=theme.darkMode;// 天氣圖標動畫類名\nconst weatherAnimClass=getWeatherAnimationClass(weather.icon);// 溫度變化動畫類名\nconst tempAnimClass=animateTemperature?tempChangeRef.current==='up'?'animate-temp-up':'animate-temp-down':'';return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:`relative w-20 h-20 ${weatherAnimClass}`,children:/*#__PURE__*/_jsx(\"img\",{src:getWeatherIcon(weather.icon),alt:weather.description,className:\"w-full h-full\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:`text-3xl font-bold transition-all duration-700 ${tempAnimClass}`,children:[Math.round(main.temp),\"\\xB0C\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"capitalize\",children:weather.description})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(ArrowUp,{className:`h-4 w-4 ${theme.highlight} mr-1`}),/*#__PURE__*/_jsxs(\"span\",{className:\"mr-2\",children:[Math.round(main.temp_max),\"\\xB0\"]}),/*#__PURE__*/_jsx(ArrowDown,{className:`h-4 w-4 ${theme.highlight} mr-1`}),/*#__PURE__*/_jsxs(\"span\",{children:[Math.round(main.temp_min),\"\\xB0\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm mt-1\",children:[\"\\u9AD4\\u611F\\u6EAB\\u5EA6: \",Math.round(main.feels_like),\"\\xB0C\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(Wind,{className:`mr-1 h-4 w-4 ${theme.highlight}`}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"\\u98A8\\u901F\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[wind.speed,\" m/s\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center text-sm\",children:[/*#__PURE__*/_jsx(Navigation,{className:`h-3 w-3 mr-1 ${theme.highlight} animate-wind-direction`,style:{transform:`rotate(${wind.deg}deg)`,animationDuration:`${Math.max(2,8-wind.speed)}s`// 風速越大，動畫越快\n}}),/*#__PURE__*/_jsx(\"span\",{children:getWindDirection(wind.deg)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(Droplets,{className:`mr-1 h-4 w-4 ${theme.highlight} animate-bounce-slow`}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"\\u6FD5\\u5EA6\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[main.humidity,\"%\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-2 bg-gray-200 rounded-full overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:`h-full ${isDarkMode?'bg-blue-400':'bg-blue-600'} transition-all duration-1000`,style:{width:`${main.humidity}%`}})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(Gauge,{className:`mr-1 h-4 w-4 ${theme.highlight} animate-pulse-slow`}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"\\u6C23\\u58D3\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[main.pressure,\" hPa\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mb-1\",children:[/*#__PURE__*/_jsx(Eye,{className:`mr-1 h-4 w-4 ${theme.highlight}`}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"\\u80FD\\u898B\\u5EA6\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[(main.visibility/1000).toFixed(1),\" km\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg transform transition hover:shadow-lg`,onMouseEnter:()=>setShowTooltip('sun'),onMouseLeave:()=>setShowTooltip(null),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Sun,{className:`mr-1 h-4 w-4 ${isDarkMode?'text-amber-300 animate-spin-slow':'text-amber-500 animate-spin-slow'}`}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"\\u65E5\\u51FA \",formatTime(main.sunrise)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Sunset,{className:`mr-1 h-4 w-4 ${isDarkMode?'text-orange-300':'text-orange-500'}`}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",children:[\"\\u65E5\\u843D \",formatTime(main.sunset)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 relative h-3 bg-gray-200 rounded-full overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-full bg-gradient-to-r from-amber-400 via-yellow-300 to-orange-400 transition-all duration-1000\",style:{width:'100%'}}),(()=>{const now=Math.floor(Date.now()/1000);const sunrise=main.sunrise;const sunset=main.sunset;const dayLength=sunset-sunrise;const position=(now-sunrise)/dayLength*100;// 白天才顯示\nif(now>=sunrise&&now<=sunset){return/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-0 w-1 h-3 bg-red-500\",style:{left:`${position}%`}});}return null;})()]}),showTooltip==='sun'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-xs text-center opacity-70\",children:[\"\\u767D\\u5929\\u6642\\u9593\\uFF1A\\u7D04 \",Math.round((main.sunset-main.sunrise)/3600),\" \\u5C0F\\u6642\"]})]})]});};// 渲染小時預報部分\nconst renderHourlyForecast=()=>{if(!forecast||!forecast.hourly)return null;const ITEMS_PER_PAGE=4;const totalItems=forecast.hourly.length;const totalPages=Math.ceil(totalItems/ITEMS_PER_PAGE);const startIdx=activeHourlyPage*ITEMS_PER_PAGE;const endIdx=Math.min(startIdx+ITEMS_PER_PAGE,totalItems);const currentItems=forecast.hourly.slice(startIdx,endIdx);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium\",children:\"\\u672A\\u4F86\\u9810\\u5831\"}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveHourlyPage(prev=>Math.max(0,prev-1)),disabled:activeHourlyPage===0,className:`p-1 rounded ${theme.darkMode?'text-white':'text-gray-600'} ${activeHourlyPage===0?'opacity-50 cursor-not-allowed':'hover:bg-gray-200'} transition transform active:scale-95`,children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\",clipRule:\"evenodd\"})})}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[activeHourlyPage+1,\"/\",totalPages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveHourlyPage(prev=>Math.min(totalPages-1,prev+1)),disabled:activeHourlyPage===totalPages-1,className:`p-1 rounded ${theme.darkMode?'text-white':'text-gray-600'} ${activeHourlyPage===totalPages-1?'opacity-50 cursor-not-allowed':'hover:bg-gray-200'} transition transform active:scale-95`,children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\",clipRule:\"evenodd\"})})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-4 gap-2\",children:currentItems.map((hour,idx)=>{const weatherAnimClass=getWeatherAnimationClass(hour.weather[0].icon);const precipChance=Math.round(hour.pop*100);return/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-2 rounded-lg text-center transform transition duration-300 hover:scale-105 hover:shadow-md`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:formatTime(hour.dt)}),/*#__PURE__*/_jsx(\"div\",{className:`w-10 h-10 mx-auto ${weatherAnimClass}`,children:/*#__PURE__*/_jsx(\"img\",{src:getWeatherIcon(hour.weather[0].icon),alt:hour.weather[0].description,className:\"w-full h-full\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold\",children:[Math.round(hour.temp),\"\\xB0\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center text-xs\",style:{opacity:precipChance>0?1:0.5},children:[/*#__PURE__*/_jsx(CloudRain,{className:`h-3 w-3 mr-1 ${precipChance>30?'animate-bounce-slow':''}`}),/*#__PURE__*/_jsxs(\"span\",{children:[precipChance,\"%\"]})]})]},idx);})})]});};// 渲染每日預報部分\nconst renderDailyForecast=()=>{if(!forecast||!forecast.daily)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium mb-2\",children:\"\\u672A\\u4F86\\u4E94\\u5929\\u9810\\u5831\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:forecast.daily.map((day,idx)=>{const weatherAnimClass=getWeatherAnimationClass(day.weather[0].icon);const precipChance=Math.round(day.pop*100);return/*#__PURE__*/_jsxs(\"div\",{className:`${theme.cardBg} p-3 rounded-lg flex items-center justify-between transform transition duration-300 hover:scale-102 hover:shadow-md`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16\",children:idx===0?'今天':formatDay(day.dt)}),/*#__PURE__*/_jsx(\"div\",{className:`w-10 h-10 ${weatherAnimClass}`,children:/*#__PURE__*/_jsx(\"img\",{src:getWeatherIcon(day.weather[0].icon),alt:day.weather[0].description,className:\"w-full h-full\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm capitalize\",children:day.weather[0].description})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",style:{opacity:precipChance>0?1:0.5},children:[/*#__PURE__*/_jsx(CloudRain,{className:`h-4 w-4 mr-1 ${precipChance>30?'animate-bounce-slow':''}`}),/*#__PURE__*/_jsxs(\"span\",{children:[precipChance,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(ArrowDown,{className:`h-4 w-4 ${theme.darkMode?'text-blue-400':'text-blue-600'}`}),/*#__PURE__*/_jsxs(\"span\",{children:[Math.round(day.temp.min),\"\\xB0\"]}),/*#__PURE__*/_jsx(ArrowUp,{className:`h-4 w-4 ${theme.darkMode?'text-red-400':'text-red-600'} ml-1`}),/*#__PURE__*/_jsxs(\"span\",{children:[Math.round(day.temp.max),\"\\xB0\"]})]})]})]},idx);})})]});};return/*#__PURE__*/_jsxs(\"div\",{className:`mb-6 ${theme.cardBg} rounded-xl p-4 ${theme.cardBorder} transition-all duration-300`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(CloudSnow,{className:`h-5 w-5 ${theme.highlight} ${loading?'animate-bounce-slow':''}`}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold\",children:\"\\u51B0\\u5CF6\\u5929\\u6C23\\u9810\\u5831\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"select\",{value:JSON.stringify(selectedLocation),onChange:e=>setSelectedLocation(JSON.parse(e.target.value)),className:`text-sm px-2 py-1 rounded ${theme.darkMode?'bg-blue-800 bg-opacity-50 text-white border-blue-600':'bg-white border-blue-300'} border transition-all duration-300 focus:ring-2 focus:ring-blue-400`,children:travelLocations.map((loc,idx)=>/*#__PURE__*/_jsx(\"option\",{value:JSON.stringify(loc),children:loc.name},idx))}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchWeatherData,disabled:loading,className:`p-1.5 rounded-full ${theme.darkMode?'bg-blue-700 hover:bg-blue-600':'bg-blue-500 hover:bg-blue-400'} text-white transition transform ${animateRefresh?'animate-spin':'hover:rotate-180'} duration-500`,title:\"\\u5237\\u65B0\\u5929\\u6C23\\u6578\\u64DA\",children:/*#__PURE__*/_jsx(RefreshCw,{className:`h-4 w-4`})})]})]}),lastUpdated&&/*#__PURE__*/_jsx(\"div\",{className:`text-xs ${theme.secondaryText} -mt-2 mb-3 animate-fade-in`,children:formatLastUpdated()}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex border-b mb-4 overflow-x-auto pb-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('current'),className:`px-3 py-2 text-sm font-medium transition-all duration-300 ${activeTab==='current'?`${theme.darkMode?'text-white':'text-blue-600'} border-b-2 ${theme.darkMode?'border-blue-400':'border-blue-600'}`:theme.secondaryText}`,children:\"\\u5373\\u6642\\u5929\\u6C23\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('hourly'),className:`px-3 py-2 text-sm font-medium transition-all duration-300 ${activeTab==='hourly'?`${theme.darkMode?'text-white':'text-blue-600'} border-b-2 ${theme.darkMode?'border-blue-400':'border-blue-600'}`:theme.secondaryText}`,children:\"\\u5C0F\\u6642\\u9810\\u5831\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('daily'),className:`px-3 py-2 text-sm font-medium transition-all duration-300 ${activeTab==='daily'?`${theme.darkMode?'text-white':'text-blue-600'} border-b-2 ${theme.darkMode?'border-blue-400':'border-blue-600'}`:theme.secondaryText}`,children:\"\\u6BCF\\u65E5\\u9810\\u5831\"})]}),loading?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center py-8 animate-fade-in\",children:[/*#__PURE__*/_jsx(\"div\",{className:`animate-spin h-10 w-10 border-4 ${theme.darkMode?'border-blue-300':'border-blue-600'} rounded-full border-t-transparent`}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:\"\\u6B63\\u5728\\u8F09\\u5165\\u5929\\u6C23\\u8CC7\\u6599...\"})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-6 animate-fade-in\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:`h-10 w-10 ${theme.darkMode?'text-red-400':'text-red-600'} mx-auto mb-2 animate-bounce-slow`}),/*#__PURE__*/_jsx(\"p\",{className:theme.darkMode?'text-red-300':'text-red-600',children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchWeatherData,className:`mt-4 px-4 py-2 ${theme.button} text-white rounded-lg transition transform hover:scale-105 active:scale-95`,children:\"\\u91CD\\u65B0\\u8F09\\u5165\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:`animate-tab-transition`,children:[activeTab==='current'&&renderCurrentWeather(),activeTab==='hourly'&&renderHourlyForecast(),activeTab==='daily'&&renderDailyForecast()]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-3 border-t border-gray-200 border-opacity-30\",children:/*#__PURE__*/_jsxs(\"div\",{className:`text-xs ${theme.secondaryText} flex items-center gap-1`,children:[/*#__PURE__*/_jsx(Info,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5929\\u6C23\\u6578\\u64DA\\u7531 OpenWeatherMap \\u63D0\\u4F9B\\uFF0C\\u53EF\\u80FD\\u96A8\\u6642\\u8B8A\\u52D5\\uFF0C\\u8ACB\\u4EE5\\u73FE\\u5834\\u5BE6\\u969B\\u60C5\\u6CC1\\u70BA\\u4E3B\"})]})})]});};export default EnhancedWeatherWidget;","map":{"version":3,"names":["React","useState","useEffect","useRef","CloudSnow","Wind","Droplets","Thermometer","Sun","Sunset","Eye","CloudRain","Clock","ArrowDown","ArrowUp","Compass","Gauge","Navigation","RefreshCw","Info","AlertTriangle","jsx","_jsx","jsxs","_jsxs","EnhancedWeatherWidget","_ref","theme","currentWeather","setCurrentWeather","forecast","setForecast","loading","setLoading","error","setError","activeHourlyPage","setActiveHourlyPage","activeTab","setActiveTab","lastUpdated","setLastUpdated","animateRefresh","setAnimateRefresh","animateTemperature","setAnimateTemperature","showTooltip","setShowTooltip","prevTempRef","tempChangeRef","travelLocations","name","lat","lon","selectedLocation","setSelectedLocation","fetchWeatherData","current","currentTemp","Math","round","main","temp","timer","setTimeout","clearTimeout","apiKey","process","env","REACT_APP_OPENWEATHER_API_KEY","currentRes","fetch","forecastRes","ok","console","status","statusText","Error","currentData","json","forecastData","sunrise","sys","sunset","visibility","hourlyForecast","list","slice","map","item","dt","feels_like","humidity","weather","pop","wind_speed","wind","speed","dailyForecast","groupedByDay","forEach","date","Date","toLocaleDateString","push","Object","entries","_ref2","index","items","noon","setHours","noonTimestamp","getTime","closestToDayItem","reduce","prev","curr","abs","temps","maxTemp","max","minTemp","min","maxPop","day","hourly","daily","err","message","getWeatherIcon","iconCode","getWeatherAnimationClass","includes","formatTime","timestamp","toLocaleTimeString","hour","minute","formatDay","days","getDay","getWindDirection","deg","directions","formatLastUpdated","renderCurrentWeather","isDarkMode","darkMode","weatherAnimClass","icon","tempAnimClass","className","children","src","alt","description","highlight","temp_max","temp_min","cardBg","style","transform","animationDuration","width","pressure","toFixed","onMouseEnter","onMouseLeave","now","floor","dayLength","position","left","renderHourlyForecast","ITEMS_PER_PAGE","totalItems","length","totalPages","ceil","startIdx","endIdx","currentItems","onClick","disabled","xmlns","viewBox","fill","fillRule","d","clipRule","idx","precipChance","opacity","renderDailyForecast","cardBorder","value","JSON","stringify","onChange","e","parse","target","loc","title","secondaryText","button"],"sources":["C:/Users/wesle/OneDrive - KU Leuven/Desktop/Iceland/my-iceland-trip-website/src/components/iceland-trip/EnhancedWeatherWidget.js"],"sourcesContent":["// src/components/iceland-trip/EnhancedWeatherWidget.js\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { \r\n  CloudSnow, Wind, Droplets, Thermometer, Sun, Sunset, Eye, \r\n  CloudRain, Clock, ArrowDown, ArrowUp, Compass, Gauge, \r\n  Navigation, RefreshCw, Info, AlertTriangle\r\n} from 'lucide-react';\r\n\r\nconst EnhancedWeatherWidget = ({ theme }) => {\r\n  const [currentWeather, setCurrentWeather] = useState(null);\r\n  const [forecast, setForecast] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [activeHourlyPage, setActiveHourlyPage] = useState(0);\r\n  const [activeTab, setActiveTab] = useState('current'); // 'current', 'hourly', 'daily'\r\n  const [lastUpdated, setLastUpdated] = useState(null);\r\n  const [animateRefresh, setAnimateRefresh] = useState(false);\r\n  const [animateTemperature, setAnimateTemperature] = useState(false);\r\n  const [showTooltip, setShowTooltip] = useState(null);\r\n  \r\n  // 用於溫度變化動畫的ref\r\n  const prevTempRef = useRef(null);\r\n  const tempChangeRef = useRef(null);\r\n  \r\n  // 主要冰島旅遊地點\r\n  const travelLocations = [\r\n    { name: \"雷克雅維克\", lat: 64.1466, lon: -21.9426 },\r\n    { name: \"教會山\", lat: 64.927, lon: -23.308 },\r\n    { name: \"黃金圈\", lat: 64.255, lon: -21.130 },\r\n    { name: \"藍湖\", lat: 63.880, lon: -22.449 },\r\n    { name: \"冰河湖\", lat: 64.047, lon: -16.181 }\r\n  ];\r\n  \r\n  const [selectedLocation, setSelectedLocation] = useState(travelLocations[0]);\r\n\r\n  // 監視地點變化，獲取數據\r\n  useEffect(() => {\r\n    fetchWeatherData();\r\n  }, [selectedLocation]);\r\n  \r\n  // 設置溫度動畫效果\r\n  useEffect(() => {\r\n    if (currentWeather && prevTempRef.current !== null) {\r\n      const currentTemp = Math.round(currentWeather.main.temp);\r\n      if (prevTempRef.current !== currentTemp) {\r\n        setAnimateTemperature(true);\r\n        tempChangeRef.current = currentTemp > prevTempRef.current ? 'up' : 'down';\r\n        \r\n        // 動畫結束後重置\r\n        const timer = setTimeout(() => {\r\n          setAnimateTemperature(false);\r\n        }, 1000);\r\n        \r\n        return () => clearTimeout(timer);\r\n      }\r\n    }\r\n    \r\n    if (currentWeather) {\r\n      prevTempRef.current = Math.round(currentWeather.main.temp);\r\n    }\r\n  }, [currentWeather]);\r\n\r\n  const fetchWeatherData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setAnimateRefresh(true); // 啟動刷新按鈕動畫\r\n      \r\n      const apiKey = process.env.REACT_APP_OPENWEATHER_API_KEY;\r\n      \r\n      // 使用當前天氣 API (免費可用)\r\n      const currentRes = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${selectedLocation.lat}&lon=${selectedLocation.lon}&units=metric&appid=${apiKey}`);\r\n      \r\n      // 使用 5-day/3-hour forecast API (免費可用)\r\n      const forecastRes = await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${selectedLocation.lat}&lon=${selectedLocation.lon}&units=metric&appid=${apiKey}`);\r\n      \r\n      if (!currentRes.ok) {\r\n        console.error(\"Current weather API failed:\", currentRes.status, currentRes.statusText);\r\n        throw new Error(`Current weather API error: ${currentRes.status}`);\r\n      }\r\n      \r\n      if (!forecastRes.ok) {\r\n        console.error(\"Forecast API failed:\", forecastRes.status, forecastRes.statusText);\r\n        throw new Error(`Forecast API error: ${forecastRes.status}`);\r\n      }\r\n      \r\n      const currentData = await currentRes.json();\r\n      const forecastData = await forecastRes.json();\r\n      \r\n      // 處理當前天氣數據\r\n      setCurrentWeather({\r\n        ...currentData,\r\n        main: {\r\n          ...currentData.main,\r\n          sunrise: currentData.sys.sunrise,\r\n          sunset: currentData.sys.sunset,\r\n          visibility: currentData.visibility\r\n        }\r\n      });\r\n      \r\n      // 處理小時預報 (取前 24 小時 / 8 個時間點)\r\n      const hourlyForecast = forecastData.list.slice(0, 8).map(item => ({\r\n        dt: item.dt,\r\n        temp: item.main.temp,\r\n        feels_like: item.main.feels_like,\r\n        humidity: item.main.humidity,\r\n        weather: item.weather,\r\n        pop: item.pop || 0, // 降水概率\r\n        wind_speed: item.wind.speed\r\n      }));\r\n      \r\n      // 處理日預報 (每天取中午的預報作為代表)\r\n      const dailyForecast = [];\r\n      const groupedByDay = {};\r\n      \r\n      // 以日期為鍵分組\r\n      forecastData.list.forEach(item => {\r\n        const date = new Date(item.dt * 1000).toLocaleDateString();\r\n        if (!groupedByDay[date]) {\r\n          groupedByDay[date] = [];\r\n        }\r\n        groupedByDay[date].push(item);\r\n      });\r\n      \r\n      // 每天取中午的預報\r\n      Object.entries(groupedByDay).forEach(([date, items], index) => {\r\n        if (index < 5) { // 最多取 5 天 (API 限制)\r\n          // 尋找最接近中午的預報\r\n          const noon = new Date(date);\r\n          noon.setHours(12, 0, 0, 0);\r\n          const noonTimestamp = noon.getTime() / 1000;\r\n          \r\n          // 找到最接近中午的預報\r\n          const closestToDayItem = items.reduce((prev, curr) => {\r\n            return Math.abs(curr.dt - noonTimestamp) < Math.abs(prev.dt - noonTimestamp) ? curr : prev;\r\n          }, items[0]);\r\n          \r\n          // 計算溫度範圍\r\n          const temps = items.map(item => item.main.temp);\r\n          const maxTemp = Math.max(...temps);\r\n          const minTemp = Math.min(...temps);\r\n          \r\n          // 計算最大降水概率\r\n          const maxPop = Math.max(...items.map(item => item.pop || 0));\r\n          \r\n          dailyForecast.push({\r\n            dt: closestToDayItem.dt,\r\n            temp: {\r\n              day: closestToDayItem.main.temp,\r\n              min: minTemp,\r\n              max: maxTemp\r\n            },\r\n            weather: closestToDayItem.weather,\r\n            pop: maxPop, // 使用當天最大降水概率\r\n            wind_speed: closestToDayItem.wind.speed\r\n          });\r\n        }\r\n      });\r\n      \r\n      setForecast({\r\n        hourly: hourlyForecast,\r\n        daily: dailyForecast\r\n      });\r\n      \r\n      setLastUpdated(new Date());\r\n      setError(null);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch weather data:\", err);\r\n      setError(`無法獲取天氣數據: ${err.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n      \r\n      // 延遲重置刷新動畫，讓動畫能完整播放\r\n      setTimeout(() => {\r\n        setAnimateRefresh(false);\r\n      }, 800);\r\n    }\r\n  };\r\n\r\n  // 輔助函數\r\n\r\n  // 取得天氣圖示並添加動畫效果\r\n  const getWeatherIcon = (iconCode) => {\r\n    return `https://openweathermap.org/img/wn/${iconCode}@2x.png`;\r\n  };\r\n  \r\n  // 根據天氣狀況獲取動畫效果類名\r\n  const getWeatherAnimationClass = (iconCode) => {\r\n    if (!iconCode) return '';\r\n    \r\n    // 下雨\r\n    if (iconCode.includes('09') || iconCode.includes('10')) {\r\n      return 'animate-rain';\r\n    }\r\n    // 下雪\r\n    else if (iconCode.includes('13')) {\r\n      return 'animate-snow';\r\n    }\r\n    // 雷雨\r\n    else if (iconCode.includes('11')) {\r\n      return 'animate-thunder';\r\n    }\r\n    // 霧\r\n    else if (iconCode.includes('50')) {\r\n      return 'animate-mist';\r\n    }\r\n    // 多雲\r\n    else if (iconCode.includes('02') || iconCode.includes('03') || iconCode.includes('04')) {\r\n      return 'animate-cloud';\r\n    }\r\n    // 晴天\r\n    else if (iconCode.includes('01')) {\r\n      return 'animate-sun';\r\n    }\r\n    \r\n    return '';\r\n  };\r\n  \r\n  // 格式化時間 (Unix timestamp)\r\n  const formatTime = (timestamp) => {\r\n    const date = new Date(timestamp * 1000);\r\n    return date.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n  \r\n  // 格式化日期 (Unix timestamp)\r\n  const formatDay = (timestamp) => {\r\n    const date = new Date(timestamp * 1000);\r\n    const days = ['週日', '週一', '週二', '週三', '週四', '週五', '週六'];\r\n    return days[date.getDay()];\r\n  };\r\n  \r\n  // 取得風向文字\r\n  const getWindDirection = (deg) => {\r\n    const directions = ['北', '東北', '東', '東南', '南', '西南', '西', '西北'];\r\n    return directions[Math.round(deg / 45) % 8];\r\n  };\r\n  \r\n  // 格式化上次更新時間\r\n  const formatLastUpdated = () => {\r\n    if (!lastUpdated) return '';\r\n    \r\n    return `最後更新: ${lastUpdated.toLocaleTimeString('zh-TW')}`;\r\n  };\r\n\r\n  // 渲染當前天氣板塊\r\n  const renderCurrentWeather = () => {\r\n    if (!currentWeather) return null;\r\n    \r\n    const weather = currentWeather.weather[0];\r\n    const main = currentWeather.main;\r\n    const wind = currentWeather.wind;\r\n    const isDarkMode = theme.darkMode;\r\n    \r\n    // 天氣圖標動畫類名\r\n    const weatherAnimClass = getWeatherAnimationClass(weather.icon);\r\n    \r\n    // 溫度變化動畫類名\r\n    const tempAnimClass = animateTemperature \r\n      ? tempChangeRef.current === 'up' \r\n        ? 'animate-temp-up' \r\n        : 'animate-temp-down'\r\n      : '';\r\n    \r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {/* 主要天氣顯示 */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <div className=\"flex items-center\">\r\n            <div className={`relative w-20 h-20 ${weatherAnimClass}`}>\r\n              <img \r\n                src={getWeatherIcon(weather.icon)} \r\n                alt={weather.description}\r\n                className=\"w-full h-full\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <div className={`text-3xl font-bold transition-all duration-700 ${tempAnimClass}`}>\r\n                {Math.round(main.temp)}°C\r\n              </div>\r\n              <div className=\"capitalize\">{weather.description}</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div>\r\n            <div className=\"flex items-center\">\r\n              <ArrowUp className={`h-4 w-4 ${theme.highlight} mr-1`} />\r\n              <span className=\"mr-2\">{Math.round(main.temp_max)}°</span>\r\n              <ArrowDown className={`h-4 w-4 ${theme.highlight} mr-1`} />\r\n              <span>{Math.round(main.temp_min)}°</span>\r\n            </div>\r\n            <div className=\"text-sm mt-1\">體感溫度: {Math.round(main.feels_like)}°C</div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 天氣詳情網格 */}\r\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2\">\r\n          {/* 風速 */}\r\n          <div className={`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`}>\r\n            <div className=\"flex items-center mb-1\">\r\n              <Wind className={`mr-1 h-4 w-4 ${theme.highlight}`} />\r\n              <div className=\"text-sm font-medium\">風速</div>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <div>{wind.speed} m/s</div>\r\n              <div className=\"flex items-center text-sm\">\r\n                <Navigation \r\n                  className={`h-3 w-3 mr-1 ${theme.highlight} animate-wind-direction`} \r\n                  style={{ \r\n                    transform: `rotate(${wind.deg}deg)`,\r\n                    animationDuration: `${Math.max(2, 8 - wind.speed)}s` // 風速越大，動畫越快\r\n                  }} \r\n                />\r\n                <span>{getWindDirection(wind.deg)}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* 濕度 */}\r\n          <div className={`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`}>\r\n            <div className=\"flex items-center mb-1\">\r\n              <Droplets className={`mr-1 h-4 w-4 ${theme.highlight} animate-bounce-slow`} />\r\n              <div className=\"text-sm font-medium\">濕度</div>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <div>{main.humidity}%</div>\r\n              <div className=\"w-16 h-2 bg-gray-200 rounded-full overflow-hidden\">\r\n                <div \r\n                  className={`h-full ${isDarkMode ? 'bg-blue-400' : 'bg-blue-600'} transition-all duration-1000`} \r\n                  style={{ width: `${main.humidity}%` }}\r\n                ></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* 氣壓 */}\r\n          <div className={`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`}>\r\n            <div className=\"flex items-center mb-1\">\r\n              <Gauge className={`mr-1 h-4 w-4 ${theme.highlight} animate-pulse-slow`} />\r\n              <div className=\"text-sm font-medium\">氣壓</div>\r\n            </div>\r\n            <div>{main.pressure} hPa</div>\r\n          </div>\r\n          \r\n          {/* 能見度 */}\r\n          <div className={`${theme.cardBg} p-3 rounded-lg transform transition hover:scale-105`}>\r\n            <div className=\"flex items-center mb-1\">\r\n              <Eye className={`mr-1 h-4 w-4 ${theme.highlight}`} />\r\n              <div className=\"text-sm font-medium\">能見度</div>\r\n            </div>\r\n            <div>{(main.visibility / 1000).toFixed(1)} km</div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* 日出/日落 */}\r\n        <div \r\n          className={`${theme.cardBg} p-3 rounded-lg transform transition hover:shadow-lg`}\r\n          onMouseEnter={() => setShowTooltip('sun')}\r\n          onMouseLeave={() => setShowTooltip(null)}\r\n        >\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center\">\r\n              <Sun className={`mr-1 h-4 w-4 ${isDarkMode ? 'text-amber-300 animate-spin-slow' : 'text-amber-500 animate-spin-slow'}`} />\r\n              <div className=\"text-sm\">日出 {formatTime(main.sunrise)}</div>\r\n            </div>\r\n            <div className=\"flex items-center\">\r\n              <Sunset className={`mr-1 h-4 w-4 ${isDarkMode ? 'text-orange-300' : 'text-orange-500'}`} />\r\n              <div className=\"text-sm\">日落 {formatTime(main.sunset)}</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"mt-2 relative h-3 bg-gray-200 rounded-full overflow-hidden\">\r\n            <div \r\n              className=\"h-full bg-gradient-to-r from-amber-400 via-yellow-300 to-orange-400 transition-all duration-1000\" \r\n              style={{ width: '100%' }}\r\n            ></div>\r\n            \r\n            {/* 當前時間標記 */}\r\n            {(() => {\r\n              const now = Math.floor(Date.now() / 1000);\r\n              const sunrise = main.sunrise;\r\n              const sunset = main.sunset;\r\n              const dayLength = sunset - sunrise;\r\n              const position = ((now - sunrise) / dayLength) * 100;\r\n              \r\n              // 白天才顯示\r\n              if (now >= sunrise && now <= sunset) {\r\n                return (\r\n                  <div \r\n                    className=\"absolute top-0 w-1 h-3 bg-red-500\"\r\n                    style={{ left: `${position}%` }}\r\n                  ></div>\r\n                );\r\n              }\r\n              return null;\r\n            })()}\r\n          </div>\r\n          \r\n          {/* 太陽路徑動畫提示 */}\r\n          {showTooltip === 'sun' && (\r\n            <div className=\"mt-2 text-xs text-center opacity-70\">白天時間：約 {Math.round((main.sunset - main.sunrise) / 3600)} 小時</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  // 渲染小時預報部分\r\n  const renderHourlyForecast = () => {\r\n    if (!forecast || !forecast.hourly) return null;\r\n    \r\n    const ITEMS_PER_PAGE = 4;\r\n    const totalItems = forecast.hourly.length;\r\n    const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);\r\n    const startIdx = activeHourlyPage * ITEMS_PER_PAGE;\r\n    const endIdx = Math.min(startIdx + ITEMS_PER_PAGE, totalItems);\r\n    const currentItems = forecast.hourly.slice(startIdx, endIdx);\r\n    \r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <h3 className=\"text-lg font-medium\">未來預報</h3>\r\n          \r\n          {/* 頁籤控制 (只有多頁時顯示) */}\r\n          {totalPages > 1 && (\r\n            <div className=\"flex items-center space-x-2\">\r\n              <button \r\n                onClick={() => setActiveHourlyPage(prev => Math.max(0, prev - 1))}\r\n                disabled={activeHourlyPage === 0}\r\n                className={`p-1 rounded ${theme.darkMode ? 'text-white' : 'text-gray-600'} ${activeHourlyPage === 0 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200'} transition transform active:scale-95`}\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n              <span className=\"text-sm\">\r\n                {activeHourlyPage + 1}/{totalPages}\r\n              </span>\r\n              <button \r\n                onClick={() => setActiveHourlyPage(prev => Math.min(totalPages - 1, prev + 1))}\r\n                disabled={activeHourlyPage === totalPages - 1}\r\n                className={`p-1 rounded ${theme.darkMode ? 'text-white' : 'text-gray-600'} ${activeHourlyPage === totalPages - 1 ? 'opacity-50 cursor-not-allowed' : 'hover:bg-gray-200'} transition transform active:scale-95`}\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        <div className=\"grid grid-cols-4 gap-2\">\r\n          {currentItems.map((hour, idx) => {\r\n            const weatherAnimClass = getWeatherAnimationClass(hour.weather[0].icon);\r\n            const precipChance = Math.round(hour.pop * 100);\r\n            \r\n            return (\r\n              <div \r\n                key={idx} \r\n                className={`${theme.cardBg} p-2 rounded-lg text-center transform transition duration-300 hover:scale-105 hover:shadow-md`}\r\n              >\r\n                <div className=\"text-sm font-medium\">\r\n                  {formatTime(hour.dt)}\r\n                </div>\r\n                <div className={`w-10 h-10 mx-auto ${weatherAnimClass}`}>\r\n                  <img \r\n                    src={getWeatherIcon(hour.weather[0].icon)} \r\n                    alt={hour.weather[0].description}\r\n                    className=\"w-full h-full\"\r\n                  />\r\n                </div>\r\n                <div className=\"text-lg font-bold\">{Math.round(hour.temp)}°</div>\r\n                <div \r\n                  className=\"flex items-center justify-center text-xs\"\r\n                  style={{ opacity: precipChance > 0 ? 1 : 0.5 }}\r\n                >\r\n                  <CloudRain className={`h-3 w-3 mr-1 ${precipChance > 30 ? 'animate-bounce-slow' : ''}`} />\r\n                  <span>{precipChance}%</span>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  // 渲染每日預報部分\r\n  const renderDailyForecast = () => {\r\n    if (!forecast || !forecast.daily) return null;\r\n    \r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <h3 className=\"text-lg font-medium mb-2\">未來五天預報</h3>\r\n        \r\n        <div className=\"space-y-2\">\r\n          {forecast.daily.map((day, idx) => {\r\n            const weatherAnimClass = getWeatherAnimationClass(day.weather[0].icon);\r\n            const precipChance = Math.round(day.pop * 100);\r\n            \r\n            return (\r\n              <div \r\n                key={idx} \r\n                className={`${theme.cardBg} p-3 rounded-lg flex items-center justify-between transform transition duration-300 hover:scale-102 hover:shadow-md`}\r\n              >\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"w-16\">\r\n                    {idx === 0 ? '今天' : formatDay(day.dt)}\r\n                  </div>\r\n                  <div className={`w-10 h-10 ${weatherAnimClass}`}>\r\n                    <img \r\n                      src={getWeatherIcon(day.weather[0].icon)} \r\n                      alt={day.weather[0].description}\r\n                      className=\"w-full h-full\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"ml-1\">\r\n                    <div className=\"text-sm capitalize\">{day.weather[0].description}</div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"flex items-center space-x-4\">\r\n                  <div \r\n                    className=\"flex items-center\"\r\n                    style={{ opacity: precipChance > 0 ? 1 : 0.5 }}\r\n                  >\r\n                    <CloudRain className={`h-4 w-4 mr-1 ${precipChance > 30 ? 'animate-bounce-slow' : ''}`} />\r\n                    <span>{precipChance}%</span>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-1\">\r\n                    <ArrowDown className={`h-4 w-4 ${theme.darkMode ? 'text-blue-400' : 'text-blue-600'}`} />\r\n                    <span>{Math.round(day.temp.min)}°</span>\r\n                    <ArrowUp className={`h-4 w-4 ${theme.darkMode ? 'text-red-400' : 'text-red-600'} ml-1`} />\r\n                    <span>{Math.round(day.temp.max)}°</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  return (\r\n    <div className={`mb-6 ${theme.cardBg} rounded-xl p-4 ${theme.cardBorder} transition-all duration-300`}>\r\n      {/* 標題與地點選擇器 */}\r\n      <div className=\"flex justify-between items-center mb-4\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <CloudSnow className={`h-5 w-5 ${theme.highlight} ${loading ? 'animate-bounce-slow' : ''}`} />\r\n          <h2 className=\"text-lg font-semibold\">冰島天氣預報</h2>\r\n        </div>\r\n        \r\n        <div className=\"flex items-center gap-2\">\r\n          {/* 地點選擇器 */}\r\n          <select\r\n            value={JSON.stringify(selectedLocation)}\r\n            onChange={(e) => setSelectedLocation(JSON.parse(e.target.value))}\r\n            className={`text-sm px-2 py-1 rounded ${theme.darkMode ? 'bg-blue-800 bg-opacity-50 text-white border-blue-600' : 'bg-white border-blue-300'} border transition-all duration-300 focus:ring-2 focus:ring-blue-400`}\r\n          >\r\n            {travelLocations.map((loc, idx) => (\r\n              <option key={idx} value={JSON.stringify(loc)}>\r\n                {loc.name}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          \r\n          {/* 刷新按鈕 */}\r\n          <button \r\n            onClick={fetchWeatherData}\r\n            disabled={loading}\r\n            className={`p-1.5 rounded-full ${theme.darkMode ? 'bg-blue-700 hover:bg-blue-600' : 'bg-blue-500 hover:bg-blue-400'} text-white transition transform ${animateRefresh ? 'animate-spin' : 'hover:rotate-180'} duration-500`}\r\n            title=\"刷新天氣數據\"\r\n          >\r\n            <RefreshCw className={`h-4 w-4`} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* 最後更新時間 */}\r\n      {lastUpdated && (\r\n        <div className={`text-xs ${theme.secondaryText} -mt-2 mb-3 animate-fade-in`}>\r\n          {formatLastUpdated()}\r\n        </div>\r\n      )}\r\n      \r\n      {/* 標籤導航 */}\r\n      <div className=\"flex border-b mb-4 overflow-x-auto pb-1\">\r\n        <button\r\n          onClick={() => setActiveTab('current')}\r\n          className={`px-3 py-2 text-sm font-medium transition-all duration-300 ${\r\n            activeTab === 'current' \r\n              ? `${theme.darkMode ? 'text-white' : 'text-blue-600'} border-b-2 ${theme.darkMode ? 'border-blue-400' : 'border-blue-600'}` \r\n              : theme.secondaryText\r\n          }`}\r\n        >\r\n          即時天氣\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab('hourly')}\r\n          className={`px-3 py-2 text-sm font-medium transition-all duration-300 ${\r\n            activeTab === 'hourly' \r\n              ? `${theme.darkMode ? 'text-white' : 'text-blue-600'} border-b-2 ${theme.darkMode ? 'border-blue-400' : 'border-blue-600'}` \r\n              : theme.secondaryText\r\n          }`}\r\n        >\r\n          小時預報\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab('daily')}\r\n          className={`px-3 py-2 text-sm font-medium transition-all duration-300 ${\r\n            activeTab === 'daily' \r\n              ? `${theme.darkMode ? 'text-white' : 'text-blue-600'} border-b-2 ${theme.darkMode ? 'border-blue-400' : 'border-blue-600'}` \r\n              : theme.secondaryText\r\n          }`}\r\n        >\r\n          每日預報\r\n        </button>\r\n      </div>\r\n      \r\n      {/* 載入中狀態 */}\r\n      {loading ? (\r\n        <div className=\"flex flex-col items-center justify-center py-8 animate-fade-in\">\r\n          <div className={`animate-spin h-10 w-10 border-4 ${theme.darkMode ? 'border-blue-300' : 'border-blue-600'} rounded-full border-t-transparent`}></div>\r\n          <div className=\"mt-4\">正在載入天氣資料...</div>\r\n        </div>\r\n      ) : error ? (\r\n        <div className=\"text-center py-6 animate-fade-in\">\r\n          <AlertTriangle className={`h-10 w-10 ${theme.darkMode ? 'text-red-400' : 'text-red-600'} mx-auto mb-2 animate-bounce-slow`} />\r\n          <p className={theme.darkMode ? 'text-red-300' : 'text-red-600'}>\r\n            {error}\r\n          </p>\r\n          <button\r\n            onClick={fetchWeatherData}\r\n            className={`mt-4 px-4 py-2 ${theme.button} text-white rounded-lg transition transform hover:scale-105 active:scale-95`}\r\n          >\r\n            重新載入\r\n          </button>\r\n        </div>\r\n      ) : (\r\n        <div className={`animate-tab-transition`}>\r\n          {activeTab === 'current' && renderCurrentWeather()}\r\n          {activeTab === 'hourly' && renderHourlyForecast()}\r\n          {activeTab === 'daily' && renderDailyForecast()}\r\n        </div>\r\n      )}\r\n      \r\n      {/* 資料相關提示 */}\r\n      <div className=\"mt-4 pt-3 border-t border-gray-200 border-opacity-30\">\r\n        <div className={`text-xs ${theme.secondaryText} flex items-center gap-1`}>\r\n          <Info className=\"h-3 w-3\" />\r\n          <span>天氣數據由 OpenWeatherMap 提供，可能隨時變動，請以現場實際情況為主</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EnhancedWeatherWidget;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}